---
description: "归档提案，复用 OpenSpec 归档机制"
---

# /admin:archive - 归档

执行此命令时，按以下流程输出：

---

## 阶段进度

```
📍 当前进度
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

  ✅ INIT → ✅ START → ✅ API → ✅ ANALYZE → ✅ DESIGN → ✅ REVIEW → ✅ APPLY → ✅ END → 🔵 ARCHIVE
                                                                                        ↑
                                                                                     你在这里
```

---

## 阶段卡片

```
┌─────────────────────────────────────────────────────────────────┐
│  📦 ARCHIVE · 归档                                              │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  📝 这一步做什么？                                               │
│     把这次的提案文档归档起来，方便以后查阅                        │
│     使用 OpenSpec 标准的归档机制                                 │
│                                                                 │
│  ⏱️ 预计耗时：< 1 分钟                                           │
│                                                                 │
│  💡 小贴士：                                                     │
│     • 归档后提案会移动到 archive/ 目录                           │
│     • 会自动更新归档索引                                         │
│     • 归档后仍可查阅，但不再修改                                 │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

## 执行步骤

### Step 1: 确认归档

```
📦 准备归档提案
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

  提案: 2026-02-11-user-log
  标题: 用户详情页添加操作日志

  包含文件:
  ├── AI-PRD-UserLog.md     需求文档
  ├── before.md             业务分析
  ├── proposal.md           提案概述
  ├── design.md             设计决策
  └── tasks.md              任务清单

  归档位置:
  → openspec/changes/archive/2026-02-11-user-log/

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

┌──────────────────────────────────────────────────────────────┐
│ 🤔 确认归档这个提案？                                         │
│                                                              │
│    [Y] 是，归档                                               │
│    [N] 否，取消                                               │
└──────────────────────────────────────────────────────────────┘
```

### Step 2: 执行归档

```
📦 正在归档...
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

  ⏳ 移动文件到 archive/ 目录...
  ⏳ 更新归档索引...
  ⏳ 清理临时文件...

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
```

### Step 3: 更新索引

```
📋 更新归档索引
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

  openspec/changes/archive/INDEX.md:

  | 日期 | 提案 | 描述 |
  |------|------|------|
  | 2026-02-11 | user-log | 用户详情页添加操作日志 | ← 新增
  | 2026-02-10 | user-list | 用户列表页重构 |
  | ... | ... | ... |

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
```

---

## 完成输出

```
┌──────────────────────────────────────────────────────────────┐
│                                                              │
│  🎉 恭喜！工作流全部完成！                                    │
│                                                              │
└──────────────────────────────────────────────────────────────┘

📊 本次工作流摘要
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

  📋 需求: PIX-8456 - 用户详情页添加操作日志

  ⏱️ 耗时: 约 25 分钟

  📂 改动:
     新增: 2 个文件
     修改: 3 个文件
     代码: +165 行

  ✅ 完成的任务:
     1. 添加用户日志 API
     2. 添加类型定义
     3. 创建 useUserLog Hook
     4. 创建 UserLogTable 组件
     5. 集成到用户详情页

  📦 归档位置:
     openspec/changes/archive/2026-02-11-user-log/

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

💬 接下来？

   🔄 开始新的需求
   👉 输入: /admin:start <新的 JIRA-KEY>

   📖 查看归档记录
   👉 打开: openspec/changes/archive/INDEX.md

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
⌨️ 快捷提示：输入 /admin 随时查看工作流全貌
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

  感谢使用管理后台 AI 开发工作流！👋

```

---

## 参数

| 参数 | 描述 | 默认值 |
|------|------|--------|
| `<proposal-name>` | 提案名称（可选，默认使用最新） | - |
| `--skip-confirm` | 跳过确认直接归档 | false |

---

## 示例

```bash
# 归档最新提案
/admin:archive

# 归档指定提案
/admin:archive 2026-02-11-user-log

# 跳过确认
/admin:archive --skip-confirm
```

---

## 归档目录结构

```
openspec/changes/archive/
├── INDEX.md                    # 归档索引
├── 2026-02-11-user-log/        # 已归档的提案
│   ├── AI-PRD-UserLog.md
│   ├── before.md
│   ├── proposal.md
│   ├── design.md
│   └── tasks.md
├── 2026-02-10-user-list/
│   └── ...
└── ...
```

---

## 常见问题

```
🆘 遇到问题？

Q: 归档后还能修改吗？
A: 可以查阅，但不建议修改已归档的提案

Q: 想恢复一个归档的提案？
A: 手动将文件从 archive/ 移回 changes/ 即可

Q: 归档索引更新失败？
A: 手动编辑 archive/INDEX.md 添加记录
```
